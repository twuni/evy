<!DOCTYPE html>
<html lang="en_US">

  <head>

    <title>Evy Console</title>

    <style>
    
      body {
        font: 14px Arial, Helvetica, sans-serif;
      }

      h1 {
        width: 90%;
        margin: 0 auto 12px;
        padding: 0 0 12px;
        font-size: 24px;
        border-bottom: solid 1px #CCC;
        position: relative;
      }
      
      h1 .version {
        position: absolute;
        top: 0;
        right: 0;
        font-size: 12px;
        opacity: 0.5;
      }

      label {
        display: block;
        width: 90%;
        margin: 0 auto;
        color: #8A8;
      }

      textarea, #output {
        display: block;
        padding: 1em;
        margin: 0.5em auto;
        width: 90%;
        height: 10em;
        box-sizing: border-box;
        border-radius: 0.5em;
        border: solid 1px #CCC;
        font: 14px Consolas, monospace;
      }

      #source {
        background-color: #FFF;
        color: #036;
        box-shadow: 0 0 3px rgba(0,32,64,0.25);
      }

      #output {
        background-color: #DFD;
        color: #030;
        box-shadow: 0 0 3px rgba(0,64,32,0.25);
      }
      
      button {

        display: block;

        width: 90%;
        margin: 12px auto;
        padding: 12px;
        border: solid 1px #000;
        border-radius: 6px;
        font: 16px Arial, Helvetica, sans-serif;
        text-shadow: 0 0 3px rgba(0,0,0,1);
        color: #FFF;
        cursor: pointer;

        background: rgb(191,210,85);
        background: -moz-linear-gradient(top,  rgba(191,210,85,1) 0%, rgba(142,185,42,1) 50%, rgba(114,170,0,1) 51%, rgba(158,203,45,1) 100%);
        background: -webkit-gradient(linear, left top, left bottom, color-stop(0%,rgba(191,210,85,1)), color-stop(50%,rgba(142,185,42,1)), color-stop(51%,rgba(114,170,0,1)), color-stop(100%,rgba(158,203,45,1)));
        background: -webkit-linear-gradient(top,  rgba(191,210,85,1) 0%,rgba(142,185,42,1) 50%,rgba(114,170,0,1) 51%,rgba(158,203,45,1) 100%);
        background: -o-linear-gradient(top,  rgba(191,210,85,1) 0%,rgba(142,185,42,1) 50%,rgba(114,170,0,1) 51%,rgba(158,203,45,1) 100%);
        background: -ms-linear-gradient(top,  rgba(191,210,85,1) 0%,rgba(142,185,42,1) 50%,rgba(114,170,0,1) 51%,rgba(158,203,45,1) 100%);
        background: linear-gradient(top,  rgba(191,210,85,1) 0%,rgba(142,185,42,1) 50%,rgba(114,170,0,1) 51%,rgba(158,203,45,1) 100%);
        filter: progid:DXImageTransform.Microsoft.gradient( startColorstr='#bfd255', endColorstr='#9ecb2d',GradientType=0 );

      }
      
      button:hover {
        background: rgb(196,213,97);
        background: -moz-linear-gradient(top,  rgba(196,213,97,1) 0%, rgba(155,202,46,1) 50%, rgba(129,194,0,1) 51%, rgba(167,211,55,1) 100%);
        background: -webkit-gradient(linear, left top, left bottom, color-stop(0%,rgba(196,213,97,1)), color-stop(50%,rgba(155,202,46,1)), color-stop(51%,rgba(129,194,0,1)), color-stop(100%,rgba(167,211,55,1)));
        background: -webkit-linear-gradient(top,  rgba(196,213,97,1) 0%,rgba(155,202,46,1) 50%,rgba(129,194,0,1) 51%,rgba(167,211,55,1) 100%);
        background: -o-linear-gradient(top,  rgba(196,213,97,1) 0%,rgba(155,202,46,1) 50%,rgba(129,194,0,1) 51%,rgba(167,211,55,1) 100%);
        background: -ms-linear-gradient(top,  rgba(196,213,97,1) 0%,rgba(155,202,46,1) 50%,rgba(129,194,0,1) 51%,rgba(167,211,55,1) 100%);
        background: linear-gradient(top,  rgba(196,213,97,1) 0%,rgba(155,202,46,1) 50%,rgba(129,194,0,1) 51%,rgba(167,211,55,1) 100%);
        filter: progid:DXImageTransform.Microsoft.gradient( startColorstr='#c4d561', endColorstr='#a7d337',GradientType=0 );
      }
      
      button:active {
        background: rgb(210,234,76);
        background: -moz-linear-gradient(top,  rgba(210,234,76,1) 0%, rgba(164,225,23,1) 50%, rgba(129,194,0,1) 51%, rgba(176,233,33,1) 100%);
        background: -webkit-gradient(linear, left top, left bottom, color-stop(0%,rgba(210,234,76,1)), color-stop(50%,rgba(164,225,23,1)), color-stop(51%,rgba(129,194,0,1)), color-stop(100%,rgba(176,233,33,1)));
        background: -webkit-linear-gradient(top,  rgba(210,234,76,1) 0%,rgba(164,225,23,1) 50%,rgba(129,194,0,1) 51%,rgba(176,233,33,1) 100%);
        background: -o-linear-gradient(top,  rgba(210,234,76,1) 0%,rgba(164,225,23,1) 50%,rgba(129,194,0,1) 51%,rgba(176,233,33,1) 100%);
        background: -ms-linear-gradient(top,  rgba(210,234,76,1) 0%,rgba(164,225,23,1) 50%,rgba(129,194,0,1) 51%,rgba(176,233,33,1) 100%);
        background: linear-gradient(top,  rgba(210,234,76,1) 0%,rgba(164,225,23,1) 50%,rgba(129,194,0,1) 51%,rgba(176,233,33,1) 100%);
        filter: progid:DXImageTransform.Microsoft.gradient( startColorstr='#d2ea4c', endColorstr='#b0e921',GradientType=0 );
      }
      
      #time-elapsed {
        margin: 1em auto;
        width: 90%;
        font-size: 12px;
        text-align: right;
        opacity: 0.5;
      }
      
      .footer {
        margin: 1em auto;
        width: 90%;
        font-size: 12px;
      }

      a {
        color: #393;
      }

    </style>

  </head>
  <body>

    <h1>
      Evy Console
      <span class="version">v0.0.1</span>
    </h1>

    <form id="code" method="get" action="?">
      <label for="source">Source</label>
      <textarea id="source">print "Hello, world!"</textarea>
      <button type="submit" id="run">Run</button>
      <label for="output">Output</label>
      <div id="output"></div>
      <div id="time-elapsed"></div>
    </form>
    
    <div class="footer">
      <p>Evy is an interpreted, event-oriented, dynamic, general purpose functional language. It is built on the paradigm of asynchronous application design, where components communicate with each other by publishing and subscribing to events.</p>
      <p>Evy is <a href="https://github.com/twuni/evy">open-source</a> software.</p>
    </div>

    <script src="evy.js"></script>

    <script>

      document.getElementById("code").addEventListener( "submit", function( event ) {

        event.preventDefault();

        var source = document.getElementById("source").value;
        var output = document.getElementById("output");

        output.innerText = "";

        var before = new Date().getTime();
        var program = Evy( source );
        program.unsubscribe( "print" );
        program.subscribe( "print", function() {
          output.innerText += arguments[0][0];
        } );
        program.execute();
        var after = new Date().getTime();
        
        if( !output.innerText ) {
          output.innerHTML = "<em style=\"opacity:0.5;\">No output</em>";
        }
        
        document.getElementById("time-elapsed").innerText = "Executed in " + ( after - before ) + " ms."

      } );

    </script>

  </body>

</html>
